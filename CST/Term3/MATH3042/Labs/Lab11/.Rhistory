knitr::opts_chunk$set(echo = TRUE)
library(mosaic)
data(TenMileRace)
library(MASS)
data(cats)
test <- function(){
conf.int.res <- t.test(sample(1:12,5,replace=T), conf.level = 0.95)$conf.int
conf.int.res[1] < 6.5 && 6.5 < conf.int.res[2]
}
n.sim <- 1e5
hits <- sum(replicate(n.sim,test()))
test <- function(){
conf.int.res <- t.test(sample(1:12, 5, replace = TRUE),
conf.level = 0.95)$conf.int
conf.int.res[1] < 6.5 && 6.5 < conf.int.res[2]
}
n.sim <- 1e5
hits <- sum(replicate(n.sim, test()))
test <- function(){
conf.int.res <- t.test(sample(1:12, 5, replace = TRUE),
conf.level = 0.95)$conf.int
conf.int.res[1] < 6.5 && 6.5 < conf.int.res[2]
}
res <- mean(replicate(1e5, test()))
test <- function() {
x <- sample(1:12, 5, replace = TRUE)
if (sd(x) == 0) {
return(FALSE)
}
ci <- t.test(x, conf.level = 0.95)$conf.int
ci[1] < 6.5 && 6.5 < ci[2]
}
res <- mean(replicate(1e5, test()))
res
knitr::opts_chunk$set(echo = TRUE)
library(MASS)
library(mosaic)
library(dplyr)
data(survey)
hist(survey$Age, breaks = 40)
c.int <- t.test(survey$Age, conf.level = 0.95)$conf.int
knitr::opts_chunk$set(echo = TRUE)
library(MASS)
library(mosaic)
library(dplyr)
data(survey)
hist(survey$Age, breaks = 40)
c.int <- t.test(survey$Age, conf.level = 0.95)$conf.int
lim.lower <- round(c.int[1],2)
lim.upper <- round(c.int[2],2)
t.test(survey$Age, mu = 19, alternative = "two.sided")
t.test(survey$Age, mu = 21, alternative = "less")
n <- sum(!is.na(survey$Pulse))
hist(survey$Pulse, breakes = 15)
n <- sum(!is.na(survey$Pulse))
hist(survey$Pulse, breaks = 15)
t.test(n)
t.test(n, mu = 75, alternative = "two.sided")
t.test(survey$Pulse, mu = 75, alternative = "two.sided")
View(survey)
female.pulse <- filter(survey$Pulse, by = survey$Sex == "Female")
female.pulse <- filter(survey$Pulse, survey$Sex == "Female")
female.pulse <- filter(survey, survey$Sex == "Female")
t.test()
female.pulse <- filter(survey, survey$Sex == "Female")
t.test()
female.pulse <- filter(survey, survey$Sex == "Female")
t.test()
female.pulse <- filter(survey, survey$Sex == "Female")$Pulse
t.test()
t.test(female.pulse, mu = 75, alternative = "less")
female.pulse <- filter(survey, survey$Sex == "Female")$Pulse
t.test(female.pulse, mu = 75, alternative = "less")
runHypothesis <- function(X.data, alpha, var, unit, mu0, alt){
t.test(X.data, mu = mu0, alternative = alt)
}
if(a <- t.test(X.data, mu = mu0, alternative = alt)$)
a <- t.test(X.data, mu = mu0, alternative = alt)
t.test(female.pulse, mu = 75, alternative = "less")
a <- t.test(female.pulse, mu = 75, alternative = "less")
View(a)
?t.test
do.test <- t.test(X.data, mu = mu0, alternative = alt)
p.val <- t.test(X.data, mu = mu0, alternative = alt)$p.value
runHypothesis(survey$Age, 0.01, "student age", "years", 20, "greater")
t.test(survey$Pulse, mu = 75, alternative = "two.sided")$p.value
female.pulse <- filter(survey, survey$Sex == "Female")$Pulse
t.test(female.pulse, mu = 75, alternative = "greater")$p.value
female.pulse <- filter(survey, survey$Sex == "Female")$Pulse
t.test(female.pulse, mu = 75, alternative = "greater")$p.value
female.pulse <- filter(survey, survey$Sex == "Female")$Pulse
t.test(female.pulse, mu = 75, alternative = "greater")$p.value
female.pulse <- filter(survey, survey$Sex == "Female")$Pulse
t.test(female.pulse, mu = 75, alternative = "greater")$p.value
runHypothesis <- function(X.data, alpha, var, unit, mu0, alt){
p.val <- t.test(X.data, mu = mu0, alternative = alt)$p.value
if(p.val < alpha){
do.have <- "have"
}else{
do.have <- "do not have"
}
res <- paste0(
"We ",
do.have,
" strong enough evidence to support the claim that the mean",
var,
"is greater than ",
mu0,unit,
"at the",
alpha * 100%,
runHypothesis <- function(X.data, alpha, var, unit, mu0, alt){
p.val <- t.test(X.data, mu = mu0, alternative = alt)$p.value
if(p.val < alpha){
do.have <- "have"
}else{
do.have <- "do not have"
}
res <- paste0(
"We ",
do.have,
" strong enough evidence to support the claim that the mean",
var,
"is greater than ",
mu0,unit,
"at the",
(alpha * 100%),
runHypothesis <- function(X.data, alpha, var, unit, mu0, alt){
p.val <- t.test(X.data, mu = mu0, alternative = alt)$p.value
if(p.val < alpha){
do.have <- "have"
}else{
do.have <- "do not have"
}
formatted.alpha <- alpha * 100%
runHypothesis <- function(X.data, alpha, var, unit, mu0, alt){
p.val <- t.test(X.data, mu = mu0, alternative = alt)$p.value
if(p.val < alpha){
do.have <- "have"
}else{
do.have <- "do not have"
}
formatted.alpha <- alpha * 100%,
runHypothesis <- function(X.data, alpha, var, unit, mu0, alt){
p.val <- t.test(X.data, mu = mu0, alternative = alt)$p.value
if(p.val < alpha){
do.have <- "have"
}else{
do.have <- "do not have"
}
formatted.alpha <- alpha * 100%,
runHypothesis <- function(X.data, alpha, var, unit, mu0, alt){
p.val <- t.test(X.data, mu = mu0, alternative = alt)$p.value
if(p.val < alpha){
do.have <- "have"
}else{
do.have <- "do not have"
}
formatted.alpha <- alpha * 100%,
runHypothesis <- function(X.data, alpha, var, unit, mu0, alt){
p.val <- t.test(X.data, mu = mu0, alternative = alt)$p.value
if(p.val < alpha){
do.have <- "have"
}else{
do.have <- "do not have"
}
formatted.alpha <- alpha * 100%,
runHypothesis <- function(X.data, alpha, var, unit, mu0, alt){
p.val <- t.test(X.data, mu = mu0, alternative = alt)$p.value
if(p.val < alpha){
do.have <- "have"
}else{
do.have <- "do not have"
}
formatted.alpha <- alpha * 100%,
runHypothesis <- function(X.data, alpha, var, unit, mu0, alt){
p.val <- t.test(X.data, mu = mu0, alternative = alt)$p.value
if(p.val < alpha){
do.have <- "have"
}else{
do.have <- "do not have"
}
formatted.alpha <- paste0(alpha * 100, "%")
res <- paste(
"We ",
do.have,
" strong enough evidence to support the claim that the mean",
var,
"is greater than ",
mu0,unit,
"at the",
formatted.alpha,
"significance level."
)
print()
}
runHypothesis(survey$Age, 0.01, "student age", "years", 20, "greater")
runHypothesis <- function(X.data, alpha, var, unit, mu0, alt){
p.val <- t.test(X.data, mu = mu0, alternative = alt)$p.value
if(p.val < alpha){
do.have <- "have"
}else{
do.have <- "do not have"
}
formatted.alpha <- paste0(alpha * 100, "%")
res <- paste(
"We ",
do.have,
" strong enough evidence to support the claim that the mean ",
var,
" is greater than ",
mu0,unit,
" at the ",
formatted.alpha,
" significance level."
)
print()
}
runHypothesis(survey$Age, 0.01, "student age", "years", 20, "greater")
runHypothesis <- function(X.data, alpha, var, unit, mu0, alt){
p.val <- t.test(X.data, mu = mu0, alternative = alt)$p.value
if(p.val < alpha){
do.have <- "have"
}else{
do.have <- "do not have"
}
formatted.alpha <- paste0(alpha * 100, "%")
res <- paste(
"We ",
do.have,
" strong enough evidence to support the claim that the mean ",
var,
" is greater than ",
mu0,unit,
" at the ",
formatted.alpha,
" significance level."
)
print(res)
}
runHypothesis(survey$Age, 0.01, "student age", "years", 20, "greater")
runHypothesis <- function(X.data, alpha, var, unit, mu0, alt){
p.val <- t.test(X.data, mu = mu0, alternative = alt)$p.value
if(p.val < alpha){
do.have <- "have"
}else{
do.have <- "do not have"
}
formatted.alpha <- paste0(alpha * 100, "%")
res <- paste(
"We",
do.have,
"strong enough evidence to support the claim that the mean",
var,
"is greater than",
mu0,unit,
"at the",
formatted.alpha,
"significance level."
)
print(res)
}
runHypothesis(survey$Age, 0.01, "student age", "years", 20, "greater")
runHypothesis <- function(X.data, alpha, var, unit, mu0, alt){
p.val <- t.test(X.data, mu = mu0, alternative = alt)$p.value
if(p.val < alpha){
do.have <- "have"
}else{
do.have <- "do not have"
}
if(alt == "greater"){
relation <- greater than")
runHypothesis <- function(X.data, alpha, var, unit, mu0, alt){
p.val <- t.test(X.data, mu = mu0, alternative = alt)$p.value
if(p.val < alpha){
do.have <- "have"
}else{
do.have <- "do not have"
}
if(alt == "greater"){
relation <- "is greater than"
}else if(alt == "less"){
relation <- "is less than"
}else{
relation <- "is different from"
}
formatted.alpha <- paste0(alpha * 100, "%")
res <- paste(
"We",
do.have,
"strong enough evidence to support the claim that the mean",
var,
relation,mu0,unit,
"at the",
formatted.alpha,
"significance level."
)
print(res)
}
runHypothesis(survey$Age, 0.01, "student age", "years", 20, "greater")
runHypothesis <- function(X.data, alpha, var, unit, mu0, alt){
p.val <- t.test(X.data, mu = mu0, alternative = alt)$p.value
if(p.val < alpha){
do.have <- "have"
}else{
do.have <- "do not have"
}
if(alt == "greater"){
relation <- "is greater than"
}else if(alt == "less"){
relation <- "is less than"
}else{
relation <- "is different from"
}
formatted.alpha <- paste0(alpha * 100, "%")
res <- paste(
"We",
do.have,
"strong enough evidence to support the claim that the mean",
var,
relation,mu0,unit,
"at the",
formatted.alpha,
"significance level."
)
print(res)
}
print("Test Q1a")
runHypothesis(survey$Age, 0.01, "student age", "years", 20, "greater")
runHypothesis(survey$Age, 0.1, "studeent age", "years", 70, "greater")
runHypothesis(survey$Pulse, 0.1, "studeent pulse", "beats per minute", 70, "greater")
runHypothesis(survey$Pulse, 0.1, "student pulse", "beats per minute", 70, "greater")
runHypothesis(survey$Pulse, 0.05, "student age", "years", 70, "less")
runHypothesis(survey$Age, 0.05, "student age", "years", 25, "less")
t.test(male.pulse, female.pulse, paired = T, var.equal)
male.pulse <- filter(survey, survey$Sex == "Male")$Pulse
t.test(male.pulse, female.pulse, paired = T, var.equal)
t.test(Pulse ~ Sex, data = survey, alternative = "two.sided")
t.test(Pulse ~ Sex, data = survey, alpha = 0.05, alternative = "two.sided")
t.test(Pulse ~ Sex, data = survey, alpha = 0.05, alternative = "two.sided")$p-value
t.test(Pulse ~ Sex, data = survey, alpha = 0.05, alternative = "two.sided")$p.value
t.test(Age ~ Sex, data = survey, alpha = 0.05, alternative = "two.sided")$p.value
t.test(Wr.Hnd, NW.Hnd, paired = TRUE, alpha = 0.05, alternative = "two.sided")
t.test(Wr.Hnd, NW.Hnd, data = survey, paired = TRUE, alpha = 0.05, alternative = "two.sided")
t.test(Wr.Hnd, NW.Hnd, data = survey, paired = TRUE, alpha = 0.05, alternative = "two.sided")
t.test(W.Hnd, NW.Hnd, data = survey, paired = TRUE, alpha = 0.05, alternative = "two.sided")
t.test(Wr.Hnd, NW.Hnd, data = survey, paired = TRUE, alpha = 0.05, alternative = "two.sided")
t.test(Wr.Hnd, NW.Hnd, data = survey, paired = TRUE, alpha = 0.05, alternative = "two.sided")
t.test(Wr.Hnd, NW.Hnd, data = survey, paired = TRUE, alpha = 0.05, alternative = "two.sided")
t.test(Wr.Hnd, NW.Hnd, data = survey, paired = TRUE, alpha = 0.05, alternative = "two.sided")
t.test(Wr.Hnd, NW.Hnd, data = survey, paired = TRUE, alpha = 0.05, alternative = "two.sided")
t.test(Wr.Hnd, NW.Hnd, data = survey, paired = TRUE, alpha = 0.05, alternative = "two.sided")
knitr::opts_chunk$set(echo = TRUE)
library(MASS)
library(mosaic)
library(dplyr)
data(survey)
hist(survey$Age, breaks = 40)
c.int <- t.test(survey$Age, conf.level = 0.95)$conf.int
lim.lower <- round(c.int[1],2)
lim.upper <- round(c.int[2],2)
t.test(survey$Age, mu = 19, alternative = "two.sided")
t.test(survey$Age, mu = 21, alternative = "less")
t.test(Wr.Hnd, NW.Hnd, data = survey, paired = TRUE, alpha = 0.05, alternative = "two.sided")
t.test(survey$Wr.Hnd, survey$NW.Hnd, paired = TRUE, alpha = 0.05, alternative = "two.sided")
t.test(survey$Wr.Hnd, survey$NW.Hnd, paired = TRUE, alpha = 0.05, alternative = "two.sided")$p.value
female.data <- subset(survey, Sex == "Female")
x <- sum(female.data$W.Hnd == "Left", na.rm = TRUE)
n <- sum(!is.na(female.data$W.Hnd))
prop.test(x, n, p = 0.10, alternative = "greater")
female.data <- subset(survey, Sex == "Female")
x <- sum(female.data$W.Hnd == "Left", na.rm = TRUE)
n <- sum(!is.na(female.data$W.Hnd))
prop.test(x, n, p = 0.10, alternative = "greater")$p.value
right.data <- subset(survey, W.Hnd == "Right")
x <- sum(right.data$Exer == "Freq", na.rm = TRUE)
n <- sum(!is.na(right.data$Exer))
prop.test(x, n, p = 0.5, alternative = "two.sided")
right.data <- subset(survey, W.Hnd == "Right")
x <- sum(right.data$Exer == "Freq", na.rm = TRUE)
n <- sum(!is.na(right.data$Exer))
prop.test(x, n, p = 0.5, alternative = "two.sided")$p.value
female.data <- subset(survey, Sex == "Female")
x <- sum(female.data$W.Hnd == "Left", na.rm = TRUE)
n <- sum(!is.na(female.data$W.Hnd))
prop.test(x, n, p = 0.10, alpha = 0.05, alternative = "greater")$p.value
female.data <- subset(survey, Sex == "Female")
x <- sum(female.data$W.Hnd == "Left", na.rm = TRUE)
n <- sum(!is.na(female.data$W.Hnd))
t.test(x, n, p = 0.10, alpha = 0.05, alternative = "greater")$p.value
right.data <- subset(survey, W.Hnd == "Right")
x <- sum(right.data$Exer == "Freq", na.rm = TRUE)
n <- sum(!is.na(right.data$Exer))
prop.test(x, n, p = 0.5, alternative = "two.sided")
right.data <- subset(survey, W.Hnd == "Right")
x <- sum(right.data$Exer == "Freq", na.rm = TRUE)
n <- sum(!is.na(right.data$Exer))
prop.test(x, n, p = 0.5, alternative = "two.sided")$p.value
never.data <- subset(survey, Smoke == "Never")
heavy.data <- subset(survey, Smoke == "Heavy")
x <- c(sum(never.data$Exer == "Freq", na.rm = TRUE),
sum(heavy.data$Exer == "Freq", na.rm = TRUE))
n <- c(sum(!is.na(never.data$Exer)), sum(!is.na(heavy.data$Exer)))
prop.test(x, n, alternative = "two.sided")
never.data <- subset(survey, Smoke == "Never")
heavy.data <- subset(survey, Smoke == "Heavy")
x <- c(sum(never.data$Exer == "Freq", na.rm = TRUE),
sum(heavy.data$Exer == "Freq", na.rm = TRUE))
n <- c(sum(!is.na(never.data$Exer)), sum(!is.na(heavy.data$Exer)))
prop.test(x, n, alternative = "two.sided")$p.value
never.data <- subset(survey, Smoke == "Never")
heavy.data <- subset(survey, Smoke == "Heavy")
x <- c(sum(never.data$Exer == "Freq", na.rm = TRUE),
sum(heavy.data$Exer == "Freq", na.rm = TRUE))
n <- c(sum(!is.na(never.data$Exer)), sum(!is.na(heavy.data$Exer)))
prop.test(x, n, alternative = "two.sided")$p.value
