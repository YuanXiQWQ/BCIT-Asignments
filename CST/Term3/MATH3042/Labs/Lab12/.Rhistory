data(survey)
library(MASS)
library(dplyr)
data(survey)
cor.test(survey$Age, survey$Height, alternative = "two.sided")
cor{X, Y, use="complete.obs"}
cor.test(survey$Age, survey$Height, alternative = "two.sided")
library(MASS)
library(dplyr)
data(survey)
X <- survey$Age
Y <- survey$Height
cor(X, Y, use="complete.obs")
cor.test(survey$Age, survey$Height, alternative = "two.sided")
X <- survey$Age
Y <- survey$Height
cor(X, Y, use = "complete.obs")
cor.test(survey$Age, survey$Height, alternative = "two.sided")
CorrelationTest <- function(X.data, Y.data, X.label, Y.label, alpha) {
r <- cor(X.data, Y.data, use = "complete.obs")
test <- cor.test(X.data, Y.data, alternative = "two.sided")
p <- test$p.value
level <- alpha * 100
if (p < alpha) {
cat("At the", level, "% significance level, there is evidence of a linear correlation between",
X.label, "and", Y.label, "(r =", round(r, 4), ", p-value =", signif(p, 4), ").\n")
} else {
cat("At the", level, "% significance level, there is no evidence of a linear correlation between",
X.label, "and", Y.label, "(r =", round(r, 4), ", p-value =", signif(p, 4), ").\n")
}
}
CorrelationTest(survey$Age, survey$Height, "Age", "Height", 0.05)
X <- survey$Age
Y <- survey$Height
cor(X, Y, use="complete.obs")
cor.test(survey$Age, survey$Height, alternative = "two.sided")
X <- survey$Age
Y <- survey$Height
cor(X, Y, use = "complete.obs")
cor.test(X, Y, alternative = "two.sided")
CorrelationTest <- function(X.data, Y.data, X.label, Y.label, alpha) {
valid <- complete.cases(X.data, Y.data)
test <- cor.test(X.data[valid], Y.data[valid], alternative = "two.sided")
level <- alpha * 100
pval <- signif(test$p.value, 4)
if (test$p.value < alpha) {
paste0("At the ", level, "% significance level, we have evidence of linear correlation between ", X.label, " and ", Y.label, " (p-value = ", pval, ").")
} else {
paste0("At the ", level, "% significance level, we do not have evidence of linear correlation between ", X.label, " and ", Y.label, " (p-value = ", pval, ").")
}
}
CorrelationTest(X, Y, "student age", "student height", 0.05)
cor(survey$Wr.Hnd, survey$NW.Hnd, use = "complete.obs")
cor(survey$Wr.Hnd, survey$NW.Hnd, use = "complete.obs")
CorrelationTest(survey$Wr.Hnd, survey$NW.Hnd, "writing hand span", "non-writing hand span", 0.05)
plot(survey$Wr.Hnd, survey$NW.Hnd,
xlab = "Writing hand span (cm)",
ylab = "Non-writing hand span (cm)",
main = "Writing vs non-writing hand span")
model <- lm(NW.Hnd ~ Wr.Hnd, data = survey)
b <- coef(model)
x0 <- 20
b[1] + b[2] * x0
cor(survey$Height, survey$NW.Hnd, use = "complete.obs")
CorrelationTest(survey$Height, survey$NW.Hnd, "student height", "non-writing hand span", 0.05)
plot(survey$Height, survey$NW.Hnd,
xlab = "Height (cm)",
ylab = "Non-writing hand span (cm)",
main = "Height vs non-writing hand span")
abline(lm(NW.Hnd ~ Height, data = survey))
model_height <- lm(NW.Hnd ~ Height, data = survey)
new_student <- data.frame(Height = 173)
predict(model_height, new_student, interval = "predict", level = 0.95)
summary(model)$sigma
summary(model_height)$sigma
x <- survey$Height
y <- survey$NW.Hnd
valid <- complete.cases(x, y)
x <- x[valid]
y <- y[valid]
n <- length(x)
model_height <- lm(y ~ x)
a <- coef(model_height)[1]
b <- coef(model_height)[2]
x0 <- 173
yhat <- a + b * x0
Se <- sqrt((sum(y^2) - a * sum(y) - b * sum(x * y)) / (n - 2))
alpha <- 0.05
tcrit <- qt(1 - alpha / 2, df = n - 2)
sx <- sd(x)
E <- tcrit * Se * sqrt(1 + 1 / n + (x0 - mean(x))^2 / ((n - 1) * sx^2))
c(yhat - E, yhat + E)
x <- survey$Height
y <- survey$NW.Hnd
valid <- complete.cases(x, y)
x <- x[valid]
y <- y[valid]
n <- length(x)
model_height <- lm(y ~ x)
a <- coef(model_height)[1]
b <- coef(model_height)[2]
x0 <- 173
yhat <- a + b * x0
Se <- sqrt((sum(y^2) - a * sum(y) - b * sum(x * y)) / (n - 2))
alpha <- 0.05
tcrit <- qt(1 - alpha / 2, df = n - 2)
sx <- sd(x)
E <- tcrit * Se * sqrt(1 + 1 / n + (x0 - mean(x))^2 / ((n - 1) * sx^2))
c(yhat - E, yhat + E)
x <- survey$Height
y <- survey$NW.Hnd
valid <- complete.cases(x, y)
x <- x[valid]
y <- y[valid]
n <- length(x)
model_height <- lm(y ~ x)
a <- coef(model_height)[1]
b <- coef(model_height)[2]
x0 <- 173
yhat <- a + b * x0
Se <- sqrt((sum(y^2) - a * sum(y) - b * sum(x * y)) / (n - 2))
alpha <- 0.05
tcrit <- qt(1 - alpha / 2, df = n - 2)
sx <- sd(x)
E <- tcrit * Se * sqrt(1 + 1 / n + (x0 - mean(x))^2 / ((n - 1) * sx^2))
c(yhat - E, yhat + E)
