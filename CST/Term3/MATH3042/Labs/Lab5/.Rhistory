library(dplyr)
library(mosaic)
setwd("F:\\JerryCode\\BCIT-Assignments\\CST\\Term3\\MATH3042\\Labs\\Lab5")
data.file <- "SFU.Weather.with.Precip.csv"
SFU.Weather <- read.csv(data.file,
colClasses = c("Date", "numeric",
"character", "numeric",
"numeric", "numeric",
"numeric"))
#1
dow <- weekdays(SFU.Weather$Date)
SFU.Weather$dow <- dow
SFU.Weather <- filter(SFU.Weather, !is.na(Temp.deg.C), !is.na(Total.Precip.mm))
Monthly.Mean.Temp <- mean(Temp.deg.C ~ Month, data=SFU.Weather)
Monthly.SD.Temp <- sd(Temp.deg.C ~ Month, data=SFU.Weather)
barplot(Monthly.Mean.Temp[c("Jan", "Feb", "Mar", "Apr",
"May", "Jun", "Jul", "Aug",
"Sep", "Oct", "Nov", "Dec")],
main = paste("Mean Daily Temperature by Month at SFU (n=",
nrow(SFU.Weather),
")"),
xlab = "Month",
ylab = "Mean Daily Temp (deg C)")
#2
z.Temp.Anomaly <- with(SFU.Weather,
(Temp.deg.C - Monthly.Mean.Temp[Month])/
Monthly.SD.Temp[Month])
SFU.Weather$z.Temp.Anomaly <- z.Temp.Anomaly
histogram(~z.Temp.Anomaly,
data = SFU.Weather,
col="#9DC3FA",
breaks = 50,
xlim = c(-5,5),
fit="normal")
# 找出缺失的行
Missing.Rows <- SFU.Weather %>%
filter(is.na(Temp.deg.C) | is.na(Total.Precip.mm))
# 打印缺失行的数量
nrow(Missing.Rows)
# 打印缺失行的日期
Missing.Rows$Date
> # 找出缺失的行
hist(SFU.Weather$z.Temp.Anomaly)
histogram(~z.Temp.Anomaly,
data = SFU.Weather,
col="#9DC3FA",
breaks = 50,
xlim = c(-5,5),
fit="normal")
#Q3
P.cold <- sum(SFU.Weather$Temp.seg == "cold")/ nrow(SFU.Weather)
#Q3
P.cold <- sum(SFU.Weather$Temp.seg == "Cold")/ nrow(SFU.Weather)
P.Mid <- sum(SFU.Weather$$Temp.seg == "Mid") / nrow(SFU.Weather)
P.Warm <- sum(SFU.Weather$$Temp.seg == "Warm") / nrow(SFU.Weather)
P.Mid <- sum(SFU.Weather$Temp.seg == "Mid") / nrow(SFU.Weather)
P.Warm <- sum(SFU.Weather$Temp.seg == "Warm") / nrow(SFU.Weather)
P.Warm
P.cold
SFU.Weather$Tem.Seg <- ifelse(SFU.Weather$z.Temp.Anomaly < -0.4307, "Cold",
ifelse(SFU.Weather$z.Temp.Anomaly <= 0.4307, "Mid",
"Warm"
)
)
#Q3
P.cold <- sum(SFU.Weather$Temp.seg == "Cold")/ nrow(SFU.Weather)
P.Mid <- sum(SFU.Weather$Temp.seg == "Mid") / nrow(SFU.Weather)
P.Warm <- sum(SFU.Weather$Temp.seg == "Warm") / nrow(SFU.Weather)
SFU.Weather$Tem.Seg <- ifelse(SFU.Weather$z.Temp.Anomaly < -0.4307, "Cold",
ifelse(SFU.Weather$z.Temp.Anomaly <= 0.4307, "Mid",
"Warm"
)
)
P.Cold
#Q3
P.Cold <- sum(SFU.Weather$Temp.seg == "Cold")/ nrow(SFU.Weather)
P.Mid <- sum(SFU.Weather$Temp.seg == "Mid") / nrow(SFU.Weather)
P.Warm <- sum(SFU.Weather$Temp.seg == "Warm") / nrow(SFU.Weather)
P.Cold
#Q3
P.Cold <- sum(SFU.Weather$Temp.Seg == "Cold")/ nrow(SFU.Weather)
P.Mid <- sum(SFU.Weather$Temp.Seg == "Mid") / nrow(SFU.Weather)
P.Warm <- sum(SFU.Weather$Temp.Seg == "Warm") / nrow(SFU.Weather)
P.Cold <- sum(SFU.Weather$Temp.Seg == "Cold")/ nrow(SFU.Weather)
P.Mid <- sum(SFU.Weather$Temp.Seg == "Mid") / nrow(SFU.Weather)
P.Warm <- sum(SFU.Weather$Temp.Seg == "Warm") / nrow(SFU.Weather)
P.Cold
source("~/.active-rstudio-document", echo = TRUE)
Monthly.Mean.Temp <- mean(~Temp.deg.C | Month, data=SFU.Weather)
Monthly.SD.Temp <- sd(~Temp.deg.C | Month, data=SFU.Weather)
barplot(Monthly.Mean.Temp[c("Jan", "Feb", "Mar", "Apr",
"May", "Jun", "Jul", "Aug",
"Sep", "Oct", "Nov", "Dec")],
main = paste("Mean Daily Temperature by Month at SFU (n=",
nrow(SFU.Weather),
")"),
xlab = "Month",
ylab = "Mean Daily Temp (deg C)")
#Q2
z.Temp.Anomaly <- with(SFU.Weather,
(Temp.deg.C - Monthly.Mean.Temp[Month])/
Monthly.SD.Temp[Month])
SFU.Weather$z.Temp.Anomaly <- z.Temp.Anomaly
hist(SFU.Weather$z.Temp.Anomaly)
histogram(~z.Temp.Anomaly,
data = SFU.Weather,
col="#9DC3FA",
breaks = 50,
xlim = c(-5,5),
fit="normal")
