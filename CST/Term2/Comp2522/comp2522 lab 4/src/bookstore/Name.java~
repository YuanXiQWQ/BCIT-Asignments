package bookstore;

import java.util.Objects;

/**
 * Represents a person's name with first and last components.
 *
 * @author Daniel Wang
 * @author Jack Le
 * @author Jiarui Xing
 * @author Uppnoor Panesar
 * @version 1.0
 */
public class Name implements Printable, Reversible {
    private final String first;
    private final String last;

    /**
     * Constructs a Name object with the given first and last names.
     *
     * @param first the first name, must not be null, blank, exceed 50 characters, or
     *              contain "admin"
     * @param last  the last name, must not be null, blank, exceed 50 characters, or
     *              contain "admin"
     * @throws IllegalArgumentException if any argument is invalid
     */
    public Name(String first, String last)
    {
        if(first == null || first.isBlank() || first.length() >= 50 ||
                first.toLowerCase().contains("admin")) {
            throw new IllegalArgumentException("Invalid first name.");
        }
        if(last == null || last.isBlank() || last.length() >= 50 ||
                last.toLowerCase().contains("admin")) {
            throw new IllegalArgumentException("Invalid last name.");
        }
        this.first = first;
        this.last = last;
    }

    /**
     * Returns the first name.
     *
     * @return the first name
     */
    public String getFirst()
    {
        return first;
    }

    /**
     * Returns the last name.
     *
     * @return the last name
     */
    public String getLast()
    {
        return last;
    }

    /**
     * Returns the initials of the name in the format "F.L."
     *
     * @return the initials
     */
    public String getInitials()
    {
        return (first.substring(0, 1) + "." + last.substring(0, 1) + ".").toUpperCase();
    }

    /**
     * Returns the full name in the format "First Last".
     *
     * @return the full name
     */
    public String getFullName()
    {
        return first + " " + last;
    }

    /**
     * Returns the reverse of the full name.
     *
     * @return the reversed name
     */
    public String getReverseName()
    {
        return new StringBuilder(getFullName()).reverse().toString();
    }

    /**
     * Displays the full name.
     */
    @Override
    public void display()
    {
        System.out.println(getFullName());
    }

    /**
     * Displays the reversed full name.
     */
    @Override
    public void backward()
    {
        System.out.println(getReverseName());
    }

    /**
     * Overrides equals to compare first and last names.
     *
     * @param obj the object to compare
     * @return true if both names are equal, false otherwise
     */
    @Override
    public boolean equals(Object obj)
    {
        if(this == obj) {
            return true;
        }
        if(!(obj instanceof Name)) {
            return false;
        }
        Name other = (Name) obj;
        return first.equals(other.first) && last.equals(other.last);
    }

    /**
     * Overrides hashCode based on first and last names.
     *
     * @return the hash code
     */
    @Override
    public int hashCode()
    {
        return Objects.hash(first, last);
    }
}
